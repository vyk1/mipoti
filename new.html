<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIPOTI - Conhecendo a Diversidade Biocultural do Brasil</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #5C917D;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            min-height: 100vh;
        }

        main {
            flex: 1;
            padding: 20px;
            width: 100%;
        }

        .container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin: 20px 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .balao {
            padding: 20px;
            text-align: center;
            max-width: 90%;
            margin: 0 auto;
            border-radius: 30px;
        }

        #btn-voltar {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin: 0 20px;
            color: white;
            cursor: pointer;
            font-size: 5em;
        }

        .azul {
            background-color: #A2D9D1;
        }

        .verde {
            background-color: #5C917D;
        }

        .vermelho {
            background-color: #d66364;
        }

        .branco {
            background-color: white;
        }

        .cientifico {
            font-weight: bold;
            font-size: 1.2em;
            font-style: italic;
            color: black;
        }

        .texto-planta p {
            font-size: 1.2em;
            line-height: 1.6;
            color: #004d40;
        }

        .texto-povo p {
            font-size: 1.2em;
            line-height: 1.6;
            color: black;
        }

        /* Lado esquerdo do texto */
        .esquerdo {
            width: 50%;
            color: white;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
        }

        .esquerdo h1 {
            font-size: 3.5em;
            font-weight: bold;
            margin: 0;
        }

        .esquerdo h2 {
            font-size: 1.8em;
            font-weight: lighter;
        }

        .esquerdo p {
            margin-top: 20px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .esquerdo .btn {
            background-color: white;
            color: #5C917D;
            padding: 15px 30px;
            text-align: center;
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
        }

        /* Lado direito do mapa */
        .direito {
            width: 50%;
            position: relative;
            overflow: hidden;
        }

        .direito img {
            width: 100%;
            height: auto;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .esquerdo,
            .direito {
                width: 100%;
                text-align: center;
            }

            .texto-planta {
                width: 90%;
            }
        }

        /* Estilo para as imagens inseridas dinamicamente */
        .plantas {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .plantas img {
            max-width: 10em;
            margin: 1%;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .plantas img:hover {
            transform: scale(1.05);
        }
    </style>
</head>

<body>
    <main>
        <div class="container">
            <div id="btn-voltar" style="display: none;">
                <p onclick="voltarParaMapaBrasil()">‚Üê üáßüá∑ </p>
            </div>
            <div class="esquerdo" id="texto-esquerdo">
            </div>

            <div class="direito">
                <div id="div-brasil">
                    <!-- SVG Brasil -->
                    <div id="mapa-brasil-biomas"></div>
                </div>

                <div id="div-bioma" style="display: none;">
                    <!-- SVG Biomas -->
                    <div id="svg-bioma"></div>
                </div>
            </div>

        </div>
    </main>
    <footer>
        <p>&copy; 2024 MIPOTI - Todos os direitos reservados</p>
    </footer>

    <script>
        // Inicializa a p√°gina com todos os SVGs escondidos
        document.querySelectorAll("svg").forEach(e => e.style = "display:none")

        // Intera√ß√µes SVG mapa BR da NatGeo
        const chavesBiomas = {
            "cls-1": {
                nome: "Mata Atl√¢ntica",
            },
            "cls-2": {
                nome: "Caatinga",
            },
            "cls-3": {
                nome: "Amaz√¥nia",
            },
            "cls-4": {
                nome: "Cerrado",
            },
            "cls-5": {
                nome: "Pantanal",
            },
            "cls-6": {
                nome: "Pampa",
            },
            "cls-7": {
                nome: null,
            },
            "cls-8": {
                nome: null,
            },
            "cls-9": {
                nome: null,
            },
        }

        const colecaoBiomas = {
            "Amaz√¥nia": {
                titulo: "Amaz√¥nia",
                descricao: "√â megadiverso! Esse aqui √© o maior bioma brasileiro e que tem a maior riqueza de esp√©cies.",
                tipoInformativo: "Para ir al√©m",
                textoInformativo: "Uma esp√©cie end√™mica √© um ser vivo que s√≥ existe em  um lugar do mundo. Por exemplo, alguns animais e  plantas s√≥ existem em certas ilhas, florestas ou no Bioma Amaz√¥nia.",
                caminhoSvg: "./assets/amazonia/amazonia-selecionada.png",
                imagens: ["./assets/amazonia/amazonia-info.png"],
                plantas: [
                    {
                        id: "andiroba",
                        nomePopular: "Andiroba",
                        nomeCientifico: "Carapa guianensis",
                        descricao: "√Årvore de grande porte! Tem casca grossa e amarga, facilmente destac√°vel em grandes lascas ou placas. Suas flores s√£o pequenas, muito perfumadas e cor de creme.",
                        foto: "./assets/amazonia/andiroba-foto.png",
                        icone: "./assets/amazonia/andiroba-icone.png",
                        informacoesPovo: [
                            {
                                nome: "Tikuna",
                                informacoes: [
                                    "Povo Tikuna √© um dos mais numerosos da regi√£o amaz√¥nica brasileira.",
                                    "Segundo a tradi√ß√£o dos Tikuna, Yo'i, um her√≥i muito importante, pescou os primeiros Tikuna das √°guas vermelhas de um igarap√© chamado Eware. ",
                                    "O rio Eware √© onde muitas das hist√≥rias do povo Tikuna come√ßaram.",
                                    "Yo'i, para n√£o ficar sozinho, usou uma vara de pescar especial e trouxe as pessoas Mag√ºta, que significa ‚Äúpessoas pescadas com vara‚Äù, para viverem perto de sua cabana, na montanha Taiwegine. ",
                                    "Esse lugar √© muito sagrado para os Tikuna at√© hoje, pois ali ainda existem marcas da casa e da vara de Yo'i.",
                                ]
                            }
                        ],
                        informacoesBotanicas: [
                            "A andiroba √© uma √°rvore de grande porte, que pode atingir at√© 30 metros de altura.",
                            "Suas flores s√£o pequenas, muito perfumadas e cor de creme.",
                        ]
                    },
                ]
            },
        };

        const divBrasil = document.getElementById('div-brasil');
        const divBioma = document.getElementById('div-bioma');
        const btnVoltar = document.getElementById('btn-voltar');
        const svgBioma = document.querySelector('#svg-bioma');
        const textoEsquerdo = document.getElementById('texto-esquerdo');

        function voltarParaMapaBrasil() {
            divBrasil.style.display = "";
            divBioma.style.display = "none";
            btnVoltar.style.display = "none";
            document.querySelector("body").style.backgroundColor = "#5C917D";
            carregarTextoInicial()
        }

        function adicionarEventosCliqueMapaBrasil() {
            document.querySelector("#mapa-brasil-biomas").querySelectorAll('path').forEach(function (path) {
                path.addEventListener('click', function (event) {
                    let nomeBioma = chavesBiomas[path.classList[0]].nome
                    // Verifica se o bioma clicado √© v√°lido
                    if (nomeBioma != null) {
                        // Esconde o mapa do Brasil
                        divBrasil.style.display = "none";
                        // Exibe o SVG do bioma
                        let biomaSelecionado = colecaoBiomas[nomeBioma];
                        carregarPngDoBioma(biomaSelecionado.caminhoSvg, svgBioma, nomeBioma);
                        //carregarSvgDoBioma(biomaSelecionado.caminhoSvg, svgBioma, nomeBioma);
                        divBioma.style.display = "";
                        btnVoltar.style.display = "";
                        // Muda cor de fundo
                        document.querySelector("body").style.backgroundColor = "#19365d";

                        let imagensPlantas = biomaSelecionado.plantas.map(planta => `<div onclick="adicionarEventoCliquePlanta('${nomeBioma}','${planta.id}')"><p>${planta.nomePopular}</p><img src="${planta.foto}" alt="${planta.title}"></div>`).join('');
                        // Acumula imagens 
                        let imagens = biomaSelecionado.imagens.map(imagem => `<img src="${imagem}" alt="${biomaSelecionado.title}">`).join('');

                        // Exibe o texto do bioma
                        // Exibe as imagens informativas do bioma
                        textoEsquerdo.innerHTML = `
                <h1>${biomaSelecionado.titulo}</h1>
                <p>${biomaSelecionado.descricao}</p>
                 <div class="informativo balao azul texto-planta">
                    <p><strong>${biomaSelecionado.tipoInformativo}</strong></p>
                    <p>${biomaSelecionado.textoInformativo}</p>
                </div>
                <div class="imagens">
                    ${imagens}
                </div>
                <div class="plantas">
                    <div>
                        ${imagensPlantas}
                    </div>
                </div>
                `;
                    }
                });
            });
        }

        // Adiciona eventos de clique ao SVG do bioma
        function adicionarEventoCliqueBiomas() {
            document.querySelector("#svg-bioma").querySelectorAll('polygon').forEach(function (polygon) {
                polygon.addEventListener('click', function (event) {
                    let nomeBioma = document.querySelector("#svg-bioma")['data-info']
                    let idPlanta = polygon.id;
                    let plantaSelecionada = colecaoBiomas[nomeBioma].plantas.find(marcador => marcador.id === idPlanta);
                    if (plantaSelecionada) {
                        textoEsquerdo.innerHTML = `
                    <h1>${plantaSelecionada.title}</h1>
                    <p>${plantaSelecionada.description}</p>
                `;
                    }
                });
            });
        }

        function adicionarEventoCliquePlanta(nomeBioma, id) {
            let plantaSelecionada = colecaoBiomas[nomeBioma].plantas.find(marcador => marcador.id === id);
            if (plantaSelecionada) {
                // Limpa imagem do bioma
                svgBioma.innerHTML = "";

                // Muda cor de fundo
                document.querySelector("body").style.backgroundColor = "#d66364";

                textoEsquerdo.innerHTML = `
                <div id="planta-selecionada">
                    <h1>${plantaSelecionada.nomePopular}</h1>
                    <hr/>
                    <h2 class="cientifico">${plantaSelecionada.nomeCientifico}</h2>
                    <img src="${plantaSelecionada.foto}" alt="${plantaSelecionada.nomePopular}"/>
                    <p>${plantaSelecionada.descricao}</p>
                    <hr/>
                    <img src="${plantaSelecionada.icone}" alt="${plantaSelecionada.nomePopular}-icone"/>
                    ${plantaSelecionada.informacoesBotanicas.map(info => `<p class="balao verde">${info}</p>`).join('')}
                </div>
                `;

                plantaSelecionada.informacoesPovo.forEach(info => {
                    svgBioma.innerHTML += `
                    <div class="informativo balao branco texto-povo">
                        <p><strong>Informa√ß√µes sobre povo ${info.nome}</strong></p>
                        ${info.informacoes.map(i => `<p>${i}</p>`).join('')}
                    </div>
                    `;
                });

            }
        }

        function carregarPngDoBioma(pngPath, container, nomeBioma) {
            fetch(pngPath)
                .then(response => response.blob())
                .then(pngData => {
                    let url = URL.createObjectURL(pngData);
                    container.innerHTML = `<img src="${url}" alt="${nomeBioma}">`;
                    container['data-info'] = nomeBioma
                })
                .catch(error => console.error('Erro ao carregar o PNG:', error));

        }

        function carregarSvgDoBioma(svgPath, container, nomeBioma) {
            fetch(svgPath)
                .then(response => response.text())
                .then(svgData => {
                    container.insertAdjacentHTML('beforeend', svgData);
                    container['data-info'] = nomeBioma
                    adicionarEventoCliqueBiomas();
                })
                .catch(error => console.error('Erro ao carregar o SVG:', error));
        }

        function carregarSvgDoBrasil(svgPath, container) {
            fetch(svgPath)
                .then(response => response.text())
                .then(svgData => {
                    container.innerHTML = svgData;
                    adicionarEventosCliqueMapaBrasil();
                })
                .catch(error => console.error('Erro ao carregar o SVG:', error));
        }

        function carregarTextoInicial() {
            textoEsquerdo.innerHTML = `
                 <h1>MIPOTI</h1>
            <h2>Conhecendo a Diversidade Biocultural do Brasil</h2>
            <p>
                Para interagir:
                <br>O Mapa Interativo de Conhecimentos de Povos Tradicionais e Povos Ind√≠genas (MIPOTI) √© uma ferramenta
                digital que permite aos usu√°rios explorar conhecimentos etnobot√¢nicos em diferentes biomas do Brasil,
                destacando as pr√°ticas culturais relacionadas ao uso de plantas em comunidades tradicionais, incluindo
                povos ind√≠genas, quilombolas e povos de terreiro, entre outros.
                <br><br>
                Clique em um Bioma para come√ßar a conhecer.
            </p>
            <a href="sobre.html" class="btn">Clique aqui para saber mais</a>
            `;
        }

        carregarTextoInicial();

        carregarSvgDoBrasil('./assets/mapa_todos-nat-geo.svg', document.getElementById('mapa-brasil-biomas'));

    </script>

</body>

</html>