<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIPOTI - Conhecendo a Diversidade Biocultural do Brasil</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #5C917D;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            min-height: 100vh;
        }

        main {
            flex: 1;
            padding: 20px;
            width: 100%;
        }

        .container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin: 20px 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .balao-azul {
            background-color: #A2D9D1;
            padding: 20px;
            text-align: center;
            max-width: 90%;
            margin: 0 auto;
            border-radius: 30px;
        }

        .texto-planta p {
            font-size: 1.2em;
            line-height: 1.6;
            color: #004d40;
        }

        /* Lado esquerdo do texto */
        .esquerdo {
            width: 50%;
            color: white;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
        }

        .esquerdo h1 {
            font-size: 3.5em;
            font-weight: bold;
            margin: 0;
        }

        .esquerdo h2 {
            font-size: 1.8em;
            font-weight: lighter;
        }

        .esquerdo p {
            margin-top: 20px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .esquerdo .btn {
            background-color: white;
            color: #5C917D;
            padding: 15px 30px;
            text-align: center;
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
        }

        /* Lado direito do mapa */
        .direito {
            width: 50%;
            position: relative;
            overflow: hidden;
        }

        .direito img {
            width: 100%;
            height: auto;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .esquerdo,
            .direito {
                width: 100%;
                text-align: center;
            }

            .texto-planta {
                width: 90%;
            }
        }

        /* Estilo para as imagens inseridas dinamicamente */
        .plantas {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .plantas img {
            max-width: 10em;
            margin: 1%;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .plantas img:hover {
            transform: scale(1.05);
        }
    </style>
</head>

<body>
    <main>
        <div class="container">
            <div class="esquerdo" id="texto-esquerdo">
            </div>

            <div class="direito">
                <div id="div-brasil">
                    <!-- SVG Brasil -->
                    <div id="mapa-brasil-biomas"></div>
                </div>

                <div id="div-bioma" style="display: none;">
                    <span onclick="voltarParaMapaBrasil()">Voltar para Brasil</span>
                    <!-- SVG Biomas -->
                    <div id="svg-bioma"></div>
                </div>
            </div>

        </div>
    </main>
    <footer>
        <p>&copy; 2024 MIPOTI - Todos os direitos reservados</p>
    </footer>

    <script>
        // Inicializa a página com todos os SVGs escondidos
        document.querySelectorAll("svg").forEach(e => e.style = "display:none")

        // Interações SVG mapa BR
        const chavesBiomas = {
            "cls-1": {
                nome: "Mata Atlântica",
            },
            "cls-2": {
                nome: "Caatinga",
            },
            "cls-3": {
                nome: "Amazônia",
            },
            "cls-4": {
                nome: "Cerrado",
            },
            "cls-5": {
                nome: "Pantanal",
            },
            "cls-6": {
                nome: "Pampa",
            },
            "cls-7": {
                nome: null,
            },
            "cls-8": {
                nome: null,
            },
            "cls-9": {
                nome: null,
            },
        }

        const colecaoBiomas = {
            "Amazônia": {
                titulo: "Amazônia",
                descricao: "É megadiverso! Esse aqui é o maior bioma brasileiro e que tem a maior riqueza de espécies.",
                tipoInformativo: "Para ir além",
                textoInformativo: "Uma espécie endêmica é um ser vivo que só existe em  um lugar do mundo. Por exemplo, alguns animais e  plantas só existem em certas ilhas, florestas ou no Bioma Amazônia.",
                caminhoSvg: "./assets/amazonia/amazonia-selecionada.png",
                imagens: ["./assets/amazonia/amazonia-info.png"],
                plantas: [
                    {
                        id: "andiroba",
                        nome: "Andiroba",
                        descricao: "...",
                        foto: "./assets/amazonia/andiroba-foto.png",
                        icone: "./assets/amazonia/andiroba-icone.png",
                        relacaoPovoPlanta: "...",
                        baloes: [
                            {
                                texto: "esta planta é usada para comer",
                                cor: "vermelho",
                            }
                        ]
                    },
                ]
            },
        };

        const divBrasil = document.getElementById('div-brasil');
        const divBioma = document.getElementById('div-bioma');
        const svgBioma = document.querySelector('#svg-bioma');
        const textoEsquerdo = document.getElementById('texto-esquerdo');

        function voltarParaMapaBrasil() {
            divBrasil.style.display = "";
            divBioma.style.display = "none";
            carregarTextoInicial()
        }

        function adicionarEventosCliqueMapaBrasil() {
            document.querySelector("#mapa-brasil-biomas").querySelectorAll('path').forEach(function (path) {
                path.addEventListener('click', function (event) {
                    let nomeBioma = chavesBiomas[path.classList[0]].nome
                    // Verifica se o bioma clicado é válido
                    if (nomeBioma != null) {
                        // Esconde o mapa do Brasil
                        divBrasil.style.display = "none";
                        // Exibe o SVG do bioma
                        let biomaSelecionado = colecaoBiomas[nomeBioma];
                        carregarPngDoBioma(biomaSelecionado.caminhoSvg, svgBioma, nomeBioma);
                        //carregarSvgDoBioma(biomaSelecionado.caminhoSvg, svgBioma, nomeBioma);
                        divBioma.style.display = "";

                        let imagensPlantas = biomaSelecionado.plantas.map(planta => `<div onclick="adicionarEventoCliquePlanta('${nomeBioma}','${planta.id}')"><p>${planta.nome}</p><img src="${planta.foto}" alt="${planta.title}"></div>`).join('');
                        // Acumula imagens 
                        let imagens = biomaSelecionado.imagens.map(imagem => `<img src="${imagem}" alt="${biomaSelecionado.title}">`).join('');

                        // Exibe o texto do bioma
                        // Exibe as imagens informativas do bioma
                        textoEsquerdo.innerHTML = `
                <h1>${biomaSelecionado.titulo}</h1>
                <p>${biomaSelecionado.descricao}</p>
                 <div class="informativo balao-azul texto-planta">
                    <p><strong>${biomaSelecionado.tipoInformativo}</strong></p>
                    <p>${biomaSelecionado.textoInformativo}</p>
                </div>
                <div class="imagens">
                    ${imagens}
                </div>
                <div class="plantas">
                    <div>
                        ${imagensPlantas}
                    </div>
                </div>
                `;
                    }
                });
            });
        }

        // Adiciona eventos de clique ao SVG do bioma
        function adicionarEventoCliqueBiomas() {
            document.querySelector("#svg-bioma").querySelectorAll('polygon').forEach(function (polygon) {
                polygon.addEventListener('click', function (event) {
                    let nomeBioma = document.querySelector("#svg-bioma")['data-info']
                    let idPlanta = polygon.id;
                    let plantaSelecionada = colecaoBiomas[nomeBioma].plantas.find(marcador => marcador.id === idPlanta);
                    if (plantaSelecionada) {
                        textoEsquerdo.innerHTML = `
                    <h1>${plantaSelecionada.title}</h1>
                    <p>${plantaSelecionada.description}</p>
                `;
                    }
                });
            });
        }

        function adicionarEventoCliquePlanta(nomeBioma, id) {
            let plantaSelecionada = colecaoBiomas[nomeBioma].plantas.find(marcador => marcador.id === id);
            if (plantaSelecionada) {
                textoEsquerdo.innerHTML = `
                    <h1>${plantaSelecionada.nome}</h1>
                    <p>${plantaSelecionada.descricao}</p>
                `;
            }
        }

        function carregarPngDoBioma(pngPath, container, nomeBioma) {
            fetch(pngPath)
                .then(response => response.blob())
                .then(pngData => {
                    let url = URL.createObjectURL(pngData);
                    container.innerHTML = `<img src="${url}" alt="${nomeBioma}">`;
                    container['data-info'] = nomeBioma
                })
                .catch(error => console.error('Erro ao carregar o PNG:', error));

        }

        function carregarSvgDoBioma(svgPath, container, nomeBioma) {
            fetch(svgPath)
                .then(response => response.text())
                .then(svgData => {
                    container.insertAdjacentHTML('beforeend', svgData);
                    container['data-info'] = nomeBioma
                    adicionarEventoCliqueBiomas();
                })
                .catch(error => console.error('Erro ao carregar o SVG:', error));
        }

        function carregarSvgDoBrasil(svgPath, container) {
            fetch(svgPath)
                .then(response => response.text())
                .then(svgData => {
                    container.innerHTML = svgData;
                    adicionarEventosCliqueMapaBrasil();
                })
                .catch(error => console.error('Erro ao carregar o SVG:', error));
        }

        function carregarTextoInicial() {
            textoEsquerdo.innerHTML = `
                 <h1>MIPOTI</h1>
            <h2>Conhecendo a Diversidade Biocultural do Brasil</h2>
            <p>
                Para interagir:
                <br>O Mapa Interativo de Conhecimentos de Povos Tradicionais e Povos Indígenas (MIPOTI) é uma ferramenta
                digital que permite aos usuários explorar conhecimentos etnobotânicos em diferentes biomas do Brasil,
                destacando as práticas culturais relacionadas ao uso de plantas em comunidades tradicionais, incluindo
                povos indígenas, quilombolas e povos de terreiro, entre outros.
                <br><br>
                Clique em um Bioma para começar a conhecer.
            </p>
            <a href="sobre.html" class="btn">Clique aqui para saber mais</a>
            `;
        }

        carregarTextoInicial();

        carregarSvgDoBrasil('./assets/mapa_todos-nat-geo.svg', document.getElementById('mapa-brasil-biomas'));

    </script>

</body>

</html>