<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <!-- <base href="/mipoti/"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçÉMIPOTI - Conhecendo a Diversidade Biocultural do Brasil atrav√©s de uma ferramenta digitalüáßüá∑</title>
    <meta name="description"
        content="MIPOTI - Conhecendo a Diversidade Biocultural do Brasil atrav√©s de uma ferramenta digital">
    <meta name="keywords" content="MIPOTI, Brasil, bioma, diversidade biocultural">
    <meta name="author" content="Victoria Botelho Martins, Luciele Leonhardt Romanowski, Sofia Zank, Natalia Hanazaki">
    <meta name="robots" content="index, follow">
    <link rel="stylesheet" href="./assets/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <main>
        <img class="moldura" src="./assets/moldura-grossa.png" alt="Moldura Grossa">
        <div class="container">
            <div id="btn-voltar" style="display: none;">
                <p onclick="voltarParaMapaBrasil()">‚Üê üáßüá∑ </p>
            </div>
            <div class="esquerdo" id="texto-esquerdo">
            </div>

            <div class="direito">
                <div id="div-brasil">
                    <div id="mapa-brasil-biomas"></div>
                </div>

                <div id="div-bioma" style="display: none;">
                    <div id="svg-bioma"></div>
                </div>
            </div>

        </div>
        <div id="lista-plantas"></div>
        <img class="moldura" src="./assets/moldura-grossa.png" alt="Moldura Grossa" />
    </main>
    <footer>
        <p>&copy; 2024 MIPOTI - Este software √© software livre, licenciado sob a MIT License.</p>
    </footer>

    <script>
        // Inicializa a p√°gina com todos os SVGs escondidos
        document.querySelectorAll("svg").forEach(e => e.style = "display:none")

        // Intera√ß√µes SVG mapa BR da NatGeo
        const chavesBiomas = {
            "cls-1": {
                nome: "Mata Atl√¢ntica",
            },
            "cls-2": {
                nome: "Caatinga",
            },
            "cls-3": {
                nome: "Amaz√¥nia",
            },
            "cls-4": {
                nome: "Cerrado",
            },
            "cls-5": {
                nome: "Pantanal",
            },
            "cls-6": {
                nome: "Pampa",
            },
            "cls-7": {
                nome: null,
            },
            "cls-8": {
                nome: null,
            },
            "cls-9": {
                nome: null,
            },
        }

        const colecaoBiomas = {
            "Amaz√¥nia": {
                titulo: "Amaz√¥nia, A Grande Floresta Tropical",
                descricao: `
    <h3>A Amaz√¥nia √© o maior bioma do Brasil, abrigando uma enorme diversidade de plantas e animais. As copas das √°rvores s√£o t√£o pr√≥ximas umas das outras que, em algumas partes, d√° at√© a impress√£o de que o c√©u √© verde. Essa cobertura densa forma um teto natural que bloqueia parte da luz solar.</h3>
    <ul>
    <li><b>Clima</b>: Quente e √∫mido, com muitas chuvas ao longo do ano.</li>
    <li><b>Apar√™ncia</b>: Uma floresta muito densa, onde grandes √°rvores dominam a paisagem e suas copas formam um ‚Äúteto‚Äù verde.</li>
    <li><b>Vegeta√ß√£o</b>: A vegeta√ß√£o √© t√£o fechada que pouca luz solar chega ao solo. Isso dificulta o crescimento de algumas plantas no ch√£o da floresta, que recebem menos energia solar para fazer fotoss√≠ntese. Em vez disso, essas plantas adaptadas ao ambiente crescem nas camadas inferiores, onde a luz √© mais escassa.</li>
    <li><b>Rios</b>: O Rio Amazonas, um dos mais longos do mundo, nasce nas geleiras dos Andes, uma cadeia de montanhas na Am√©rica do Sul. As √°guas de degelo dessas geleiras s√£o fundamentais para o nascimento do rio, que depois percorre milhares de quil√¥metros at√© chegar ao Oceano Atl√¢ntico. A import√¢ncia das geleiras √© imensa, pois elas garantem um fluxo cont√≠nuo de √°gua para o rio, mesmo nas √©pocas mais secas do ano.</li>
    <li><b>Curiosidade</b>: Um famoso morador √© o boto-cor-de-rosa, que vive nas √°guas dos rios, ao lado de outras esp√©cies √∫nicas como o peixe-boi e a ariranha.</li>
    </ul>

`,
                tipoInformativo: "Para ir al√©m",
                textoInformativo: "Uma esp√©cie end√™mica √© um ser vivo que s√≥ existe em um lugar do mundo. Por exemplo, alguns animais e plantas s√≥ existem em certas ilhas, florestas ou no Bioma Amaz√¥nia.",
                caminhoSvg: "./assets/amazonia/amazonia-selecionada.png",
                imagens: ["./assets/amazonia/amazonia-info.png"],
                plantas: [
                    {
                        id: "andiroba",
                        nomePopular: "Andiroba",
                        nomeCientifico: "Carapa guianensis",
                        descricao: "√Årvore de grande porte! Tem casca grossa e amarga, facilmente destac√°vel em grandes lascas ou placas. Suas flores s√£o pequenas, muito perfumadas e cor de creme.",
                        foto: "./assets/amazonia/andiroba-foto.png",
                        icone: "./assets/amazonia/andiroba-icone.png",
                        informacoesPovo: [
                            {
                                nome: "Tikuna",
                                informacoes: [
                                    "Povo Tikuna √© um dos mais numerosos da regi√£o amaz√¥nica brasileira.",
                                    "Segundo a tradi√ß√£o dos Tikuna, Yo'i, um her√≥i muito importante, pescou os primeiros Tikuna das √°guas vermelhas de um igarap√© chamado Eware. ",
                                    "O rio Eware √© onde muitas das hist√≥rias do povo Tikuna come√ßaram.",
                                    "Yo'i, para n√£o ficar sozinho, usou uma vara de pescar especial e trouxe as pessoas Mag√ºta, que significa ‚Äúpessoas pescadas com vara‚Äù, para viverem perto de sua cabana, na montanha Taiwegine. ",
                                    "Esse lugar √© muito sagrado para os Tikuna at√© hoje, pois ali ainda existem marcas da casa e da vara de Yo'i.",
                                ]
                            }
                        ],
                        informacoesBotanicas: [
                            "A andiroba √© uma √°rvore de grande porte, que pode atingir at√© 30 metros de altura.",
                            "Suas flores s√£o pequenas, muito perfumadas e cor de creme.",
                        ]
                    },
                ]
            },
        };

        const divBrasil = document.getElementById('div-brasil');
        const divBioma = document.getElementById('div-bioma');
        const btnVoltar = document.getElementById('btn-voltar');
        const svgBioma = document.querySelector('#svg-bioma');
        const textoEsquerdo = document.getElementById('texto-esquerdo');
        const listaPlantas = document.getElementById('lista-plantas');

        function voltarParaMapaBrasil() {
            divBrasil.style.display = "";
            divBioma.style.display = "none";
            btnVoltar.style.display = "none";
            listaPlantas.innerHTML = "";
            document.querySelector("body").style.backgroundColor = "#5C917D";
            carregarTextoInicial()
        }

        function adicionarEventosCliqueMapaBrasil() {
            document.querySelector("#mapa-brasil-biomas").querySelectorAll('path').forEach(function (path) {
                path.addEventListener('click', function (event) {
                    let nomeBioma = chavesBiomas[path.classList[0]].nome
                    // Verifica se o bioma clicado √© v√°lido
                    if (nomeBioma != null) {
                        // Esconde o mapa do Brasil
                        divBrasil.style.display = "none";
                        // Exibe o SVG do bioma
                        let biomaSelecionado = colecaoBiomas[nomeBioma];
                        //carregarPngDoBioma(biomaSelecionado.caminhoSvg, svgBioma, nomeBioma);
                        svgBioma.innerHTML = `<img src="${biomaSelecionado.caminhoSvg}" alt="${nomeBioma}">`;
                        divBioma.style.display = "";
                        btnVoltar.style.display = "";
                        // Muda cor de fundo
                        document.querySelector("body").style.backgroundColor = "#19365d";

                        let imagensPlantas = biomaSelecionado.plantas.map(planta => `
                        <div onclick="adicionarEventoCliquePlanta('${nomeBioma}','${planta.id}')">
                            <p>${planta.nomePopular}</p>
                            <img src="${planta.foto}" alt="${planta.titulo}">
                        </div>`).join('');

                        // Acumula imagens 
                        let imagensInformativo = biomaSelecionado.imagens.map((imagem, i) => `<img src="${imagem}" alt="${nomeBioma + i}">`).join('');

                        // Exibe o texto do bioma
                        // Exibe as imagens informativas do bioma
                        textoEsquerdo.innerHTML = `
                <h1>${biomaSelecionado.titulo}</h1>
                <p>${biomaSelecionado.descricao}</p>
               
                <div class="imagens-informativo">
                    ${imagensInformativo}
                </div>
                
                `;

                        svgBioma.innerHTML += `
  <div class="informativo balao azul texto-planta">
                    <p><strong>${biomaSelecionado.tipoInformativo}</strong></p>
                    <p>${biomaSelecionado.textoInformativo}</p>
                </div>
                    `;

                        listaPlantas.innerHTML = `
                        <img class="moldura" src="./assets/moldura-fina.png" alt="Moldura fina" />
                    <h1 class="plantas">(Algumas) Plantas do Bioma</h1>
                    <div class="plantas">
                        ${imagensPlantas}
                    </div>
                `

                    }
                });
            });
        }

        // Adiciona eventos de clique ao SVG do bioma
        function adicionarEventoCliqueBiomas() {
            document.querySelector("#svg-bioma").querySelectorAll('polygon').forEach(function (polygon) {
                polygon.addEventListener('click', function (event) {
                    let nomeBioma = document.querySelector("#svg-bioma")['data-info']
                    let idPlanta = polygon.id;
                    let plantaSelecionada = colecaoBiomas[nomeBioma].plantas.find(marcador => marcador.id === idPlanta);
                    if (plantaSelecionada) {
                        textoEsquerdo.innerHTML = `
                    <h1>${plantaSelecionada.title}</h1>
                    <p>${plantaSelecionada.description}</p>
                `;
                    }
                });
            });
        }

        function adicionarEventoCliquePlanta(nomeBioma, id) {
            let plantaSelecionada = colecaoBiomas[nomeBioma].plantas.find(marcador => marcador.id === id);
            if (plantaSelecionada) {
                // Limpa imagem do bioma
                svgBioma.innerHTML = "";

                // Limpa lista de plantas
                listaPlantas.innerHTML = "";

                // Muda cor de fundo
                document.querySelector("body").style.backgroundColor = "#d66364";

                textoEsquerdo.innerHTML = `
                <div id="planta-selecionada">
                    <h1>${plantaSelecionada.nomePopular}</h1>
                    <hr/>
                    <h2 class="cientifico">${plantaSelecionada.nomeCientifico}</h2>
                    <img src="${plantaSelecionada.foto}" alt="${plantaSelecionada.nomePopular}"/>
                    <p>${plantaSelecionada.descricao}</p>
                    <hr/>
                    <img src="${plantaSelecionada.icone}" alt="${plantaSelecionada.nomePopular}-icone"/>
                    ${plantaSelecionada.informacoesBotanicas.map(info => `<p class="balao verde">${info}</p>`).join('')}
                </div>
                `;

                plantaSelecionada.informacoesPovo.forEach(info => {
                    svgBioma.innerHTML += `
                    <div class="informativo balao branco texto-povo">
                        <p><strong>Informa√ß√µes sobre povo ${info.nome}</strong></p>
                        ${info.informacoes.map(i => `<p>${i}</p>`).join('')}
                    </div>
                    `;
                });

            }
        }

        function carregarPngDoBioma(pngPath, container, nomeBioma) {
            fetch(pngPath)
                .then(response => response.blob())
                .then(pngData => {
                    let url = URL.createObjectURL(pngData);

                })
                .catch(error => console.error('Erro ao carregar o PNG:', error));

        }

        function carregarSvgDoBioma(svgPath, container, nomeBioma) {
            fetch(svgPath)
                .then(response => response.text())
                .then(svgData => {
                    container.insertAdjacentHTML('beforeend', svgData);
                    container['data-info'] = nomeBioma
                    adicionarEventoCliqueBiomas();
                })
                .catch(error => console.error('Erro ao carregar o SVG:', error));
        }

        function carregarSvgDoBrasil(svgPath, container) {
            fetch(svgPath)
                .then(response => response.text())
                .then(svgData => {
                    container.innerHTML = svgData;
                    adicionarEventosCliqueMapaBrasil();
                })
                .catch(error => console.error('Erro ao carregar o SVG:', error));
        }

        function carregarTextoInicial() {
            textoEsquerdo.innerHTML = `
                 <h1>MIPOTI</h1>
            <h2>Conhecendo a Diversidade Biocultural do Brasil</h2>
            <p>
                Para interagir:
                <br>O Mapa Interativo de Conhecimentos de Povos Tradicionais e Povos Ind√≠genas (MIPOTI) √© uma ferramenta
                digital que permite aos usu√°rios explorar conhecimentos etnobot√¢nicos em diferentes biomas do Brasil,
                destacando as pr√°ticas culturais relacionadas ao uso de plantas em comunidades tradicionais, incluindo
                povos ind√≠genas, quilombolas e povos de terreiro, entre outros.
                <br><br>
                Clique em um Bioma para come√ßar a conhecer.
            </p>
            <a href="sobre.html" class="btn">Clique aqui para saber mais</a>
            `;
        }

        carregarTextoInicial();

        carregarSvgDoBrasil('./assets/mapa_todos-nat-geo.svg', document.getElementById('mapa-brasil-biomas'));

    </script>

</body>

</html>